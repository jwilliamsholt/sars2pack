<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Align case tracking locations (for example) to a common baseline — align_to_baseline • sars2pack</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Align case tracking locations (for example) to a common baseline — align_to_baseline" />
<meta property="og:description" content="When endeavoring to compare epidemic curves (cases vs date, for
example), particularly when making graphical displays, it is helpful
to set a &quot;time baseline&quot; that aligns where all the curves start." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-4');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sars2pack</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.0.54-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/add_a_dataset.html">How to add a new dataset to sars2pack</a>
    </li>
    <li>
      <a href="../articles/case_tracking.html">Case tracking datasets</a>
    </li>
    <li>
      <a href="../articles/datasets.html">Overview of available datasets</a>
    </li>
    <li>
      <a href="../articles/doMCMC.html">Building MCMC-based models of SI for SARS-Cov-2</a>
    </li>
    <li>
      <a href="../articles/index.html">Introduction to sars2pack</a>
    </li>
    <li>
      <a href="../articles/map_visualization.html">Geospatial visualization of COVID-19 datasets</a>
    </li>
    <li>
      <a href="../articles/more_visualization.html">Visualizing geographic COVID-19 trends without maps</a>
    </li>
    <li>
      <a href="../articles/overview.html">Exploring the COVID-19 pandemic using sars2pack</a>
    </li>
    <li>
      <a href="../articles/r0_estimates.html">Estimating the replication rate, $R_0$</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/seandavi/sars2pack">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Align case tracking locations (for example) to a common baseline</h1>
    <small class="dont-index">Source: <a href='https://github.com/seandavi/sars2pack/blob/master/R/align_to_baseline.R'><code>R/align_to_baseline.R</code></a></small>
    <div class="hidden name"><code>align_to_baseline.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When endeavoring to compare epidemic curves (cases vs date, for
example), particularly when making graphical displays, it is helpful
to set a "time baseline" that aligns where all the curves start.</p>
    </div>

    <pre class="usage"><span class='fu'>align_to_baseline</span>(<span class='no'>df</span>, <span class='no'>filter_criteria</span>, <span class='kw'>date_column</span> <span class='kw'>=</span> <span class='st'>"date"</span>, <span class='no'>group_vars</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>data.frame that includes a date column and at least one other column
for filtering, typically a case count.</p></td>
    </tr>
    <tr>
      <th>filter_criteria</th>
      <td><p>an expression as would normally be specified
directly to <code><a href='https://dplyr.tidyverse.org/reference/filter.html'>dplyr::filter()</a></code>.</p></td>
    </tr>
    <tr>
      <th>date_column</th>
      <td><p>character(1) column name of the column for ordering
the data to define a "beginning" of the curve. It is called a
"date column", but anything with a natural ordering will likely work.</p></td>
    </tr>
    <tr>
      <th>group_vars</th>
      <td><p>optional character() column_name(s) that specify
grouping done before calculating minimum <code>date</code>s. Concretely,
if the goal is to compare several countries, then the group_vars='country'
with a column in <code>df</code> called <code>country</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with a new column, <code>index</code>, that gives the
number of time intervals (typically days) from when the
baseline counts are first encountered, done by group.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes this basic approach:</p><ol>
<li><p>Filter all all data using the <code>filter_criteria</code>, expressed as a
<code><a href='https://dplyr.tidyverse.org/reference/filter.html'>dplyr::filter()</a></code> expression.</p></li>
<li><p>Optionally group the dataset.</p></li>
<li><p>Find the minimum date left after applying the filter criteria</p></li>
<li><p>"Subtract" the minimum date (on a per group basis if grouping
columns are used).</p></li>
</ol>

<p>The result is a plot that shifts all the curves to start at the "same"
starting time with respect to the "start" of the pandemic. For example,
for the COVID-19 pandemic, China started much earlier than the rest of
the world. To compare the time course of China versus other countries,
setting the time to the point where each country had 100 cases allows
direct comparison of the shapes of the countries' curves.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other case-tracking: 
<code><a href='beoutbreakprepared_data.html'>beoutbreakprepared_data</a>()</code>,
<code><a href='bulk_estimate_Rt.html'>bulk_estimate_Rt</a>()</code>,
<code><a href='combined_us_cases_data.html'>combined_us_cases_data</a>()</code>,
<code><a href='covidtracker_data.html'>covidtracker_data</a>()</code>,
<code><a href='ecdc_data.html'>ecdc_data</a>()</code>,
<code><a href='estimate_Rt.html'>estimate_Rt</a>()</code>,
<code><a href='eu_data_cache_data.html'>eu_data_cache_data</a>()</code>,
<code><a href='jhu_data.html'>jhu_data</a>()</code>,
<code><a href='nytimes_county_data.html'>nytimes_county_data</a>()</code>,
<code><a href='owid_data.html'>owid_data</a>()</code>,
<code><a href='plot_epicurve.html'>plot_epicurve</a>()</code>,
<code><a href='usa_facts_data.html'>usa_facts_data</a>()</code></p>
<p>Other plotting: 
<code><a href='plot_epicurve.html'>plot_epicurve</a>()</code>,
<code><a href='plot_projection.html'>plot_projection</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)

<span class='co'># use European CDC dataset</span>
<span class='no'>ecdc</span> <span class='kw'>=</span> <span class='fu'><a href='ecdc_data.html'>ecdc_data</a></span>()
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>ecdc</span>)</div><div class='output co'>#&gt; # A tibble: 6 x 8
#&gt; # Groups:   location_name [1]
#&gt;   date       location_name iso2c iso3c population_2018 continent subset    count
#&gt;   &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;
#&gt; 1 2019-12-31 Afghanistan   AF    AFG          37172386 Asia      deaths        0
#&gt; 2 2019-12-31 Afghanistan   AF    AFG          37172386 Asia      confirmed     0
#&gt; 3 2020-01-01 Afghanistan   AF    AFG          37172386 Asia      deaths        0
#&gt; 4 2020-01-01 Afghanistan   AF    AFG          37172386 Asia      confirmed     0
#&gt; 5 2020-01-02 Afghanistan   AF    AFG          37172386 Asia      deaths        0
#&gt; 6 2020-01-02 Afghanistan   AF    AFG          37172386 Asia      confirmed     0</div><div class='input'><span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/reexports.html'>glimpse</a></span>(<span class='no'>ecdc</span>)</div><div class='output co'>#&gt; Rows: 35,988
#&gt; Columns: 8
#&gt; Groups: location_name [210]
#&gt; $ date            &lt;date&gt; 2019-12-31, 2019-12-31, 2020-01-01, 2020-01-01, 2020…
#&gt; $ location_name   &lt;chr&gt; "Afghanistan", "Afghanistan", "Afghanistan", "Afghani…
#&gt; $ iso2c           &lt;chr&gt; "AF", "AF", "AF", "AF", "AF", "AF", "AF", "AF", "AF",…
#&gt; $ iso3c           &lt;chr&gt; "AFG", "AFG", "AFG", "AFG", "AFG", "AFG", "AFG", "AFG…
#&gt; $ population_2018 &lt;dbl&gt; 37172386, 37172386, 37172386, 37172386, 37172386, 371…
#&gt; $ continent       &lt;chr&gt; "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia…
#&gt; $ subset          &lt;chr&gt; "deaths", "confirmed", "deaths", "confirmed", "deaths…
#&gt; $ count           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</div><div class='input'>
<span class='co'># get top 10 countries by cumulative</span>
<span class='co'># number of deaths</span>
<span class='no'>top_10</span> <span class='kw'>=</span> <span class='no'>ecdc</span> <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>subset</span><span class='kw'>==</span><span class='st'>'deaths'</span>) <span class='kw'>%&gt;%</span>
    <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>location_name</span>) <span class='kw'>%&gt;%</span>
    <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span>(<span class='kw'>count</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='no'>count</span>)) <span class='kw'>%&gt;%</span>
    <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span>(<span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span>(<span class='no'>count</span>)) <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fl'>10</span>)

<span class='no'>top_10</span></div><div class='output co'>#&gt; # A tibble: 10 x 2
#&gt;    location_name            count
#&gt;    &lt;chr&gt;                    &lt;dbl&gt;
#&gt;  1 United_States_of_America 90353
#&gt;  2 United_Kingdom           34796
#&gt;  3 Italy                    32007
#&gt;  4 France                   28239
#&gt;  5 Spain                    27709
#&gt;  6 Brazil                   16792
#&gt;  7 Belgium                   9080
#&gt;  8 Germany                   8007
#&gt;  9 Iran                      7057
#&gt; 10 Canada                    5842</div><div class='input'>
<span class='co'># limit ecdc data to "deaths" and</span>
<span class='co'># top 10 countries</span>

<span class='no'>ecdc_top10</span> <span class='kw'>=</span> <span class='no'>ecdc</span> <span class='kw'>%&gt;%</span>
    <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>subset</span><span class='kw'>==</span><span class='st'>'deaths'</span> <span class='kw'>&amp;</span> <span class='no'>location_name</span> <span class='kw'>%in%</span> <span class='no'>top_10</span><span class='kw'>[[</span><span class='st'>'location_name'</span>]])
<span class='fu'><a href='plot_epicurve.html'>plot_epicurve</a></span>(<span class='no'>ecdc_top10</span>, <span class='kw'>color</span><span class='kw'>=</span><span class='st'>'location_name'</span>)</div><div class='img'><img src='align_to_baseline-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>ecdc_top10_baseline</span> <span class='kw'>=</span> <span class='fu'>align_to_baseline</span>(<span class='no'>ecdc_top10</span>, <span class='no'>count</span><span class='kw'>&gt;</span><span class='fl'>100</span>, <span class='kw'>group_vars</span><span class='kw'>=</span><span class='st'>'location_name'</span>)

<span class='fu'><a href='plot_epicurve.html'>plot_epicurve</a></span>(<span class='no'>ecdc_top10_baseline</span>, <span class='kw'>date_column</span><span class='kw'>=</span><span class='st'>'index'</span>, <span class='kw'>color</span><span class='kw'>=</span><span class='st'>'location_name'</span>) +
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span>(<span class='st'>'Deaths over time, aligned to date of 100 deaths per country'</span>)</div><div class='img'><img src='align_to_baseline-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sean Davis, VJ Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


